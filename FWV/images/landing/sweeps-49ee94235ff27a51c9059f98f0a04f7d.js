/*!
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
!function(e){function t(t,i,n,r){var a={data:r||0===r||r===!1?r:i?i.data:{},_wrap:i?i._wrap:null,tmpl:null,parent:i||null,nodes:[],calls:u,nest:c,wrap:d,html:h,update:p};return t&&e.extend(a,t,{nodes:[],parent:i}),n&&(a.tmpl=n,a._ctnt=a._ctnt||a.tmpl(e,a),a.key=++w,(x.length?_:y)[w]=a),a}function i(t,r,a){var s,o=a?e.map(a,function(e){return"string"==typeof e?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+m+'="'+t.key+'" $2'):e:i(e,t,e._ctnt)}):t;return r?o:(o=o.join(""),o.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,i,r,a){s=e(r).get(),l(s),i&&(s=n(i).concat(s)),a&&(s=s.concat(n(a)))}),s?s:n(o))}function n(t){var i=document.createElement("div");return i.innerHTML=t,e.makeArray(i.childNodes)}function r(t){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+e.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,i,n,r,a,o,l){var u,c,d,h=e.tmpl.tag[n];if(!h)throw"Unknown template tag: "+n;return u=h._default||[],o&&!/\w$/.test(a)&&(a+=o,o=""),a?(a=s(a),l=l?","+s(l)+")":o?")":"",c=o?a.indexOf(".")>-1?a+s(o):"("+a+").call($item"+l:a,d=o?c:"(typeof("+a+")==='function'?("+a+").call($item):("+a+"))"):d=c=u.$1||"null",r=s(r),"');"+h[i?"close":"open"].split("$notnull_1").join(a?"typeof("+a+")!=='undefined' && ("+a+")!=null":"true").split("$1a").join(d).split("$1").join(c).split("$2").join(r||u.$2||"")+"__.push('"})+"');}return __;")}function a(t,n){t._wrap=i(t,!0,e.isArray(n)?n:[v.test(n)?n:e(n).html()]).join("")}function s(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function o(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function l(i){function n(i){function n(e){e+=u,s=c[e]=c[e]||t(s,y[s.parent.key+u]||s.parent)}var r,a,s,o,l=i;if(o=i.getAttribute(m)){for(;l.parentNode&&1===(l=l.parentNode).nodeType&&!(r=l.getAttribute(m)););r!==o&&(l=l.parentNode?11===l.nodeType?0:l.getAttribute(m)||0:0,(s=y[o])||(s=_[o],s=t(s,y[l]||_[l]),s.key=++w,y[w]=s),k&&n(o)),i.removeAttribute(m)}else k&&(s=e.data(i,"tmplItem"))&&(n(s.key),y[s.key]=s,l=e.data(i.parentNode,"tmplItem"),l=l?l.key:0);if(s){for(a=s;a&&a.key!=l;)a.nodes.push(i),a=a.parent;delete s._ctnt,delete s._wrap,e.data(i,"tmplItem",s)}}var r,a,s,o,l,u="_"+k,c={};for(s=0,o=i.length;o>s;s++)if(1===(r=i[s]).nodeType){for(a=r.getElementsByTagName("*"),l=a.length-1;l>=0;l--)n(a[l]);n(r)}}function u(e,t,i,n){return e?(x.push({_:e,tmpl:t,item:this,data:i,options:n}),void 0):x.pop()}function c(t,i,n){return e.tmpl(e.template(t),i,n,this)}function d(t,i){var n=t.options||{};return n.wrapped=i,e.tmpl(e.template(t.tmpl),t.data,n,t.item)}function h(t,i){var n=this._wrap;return e.map(e(e.isArray(n)?n.join(""):n).filter(t||"*"),function(e){return i?e.innerText||e.textContent:e.outerHTML||o(e)})}function p(){var t=this.nodes;e.tmpl(null,null,null,this).insertBefore(t[0]),e(t).remove()}var f,g=e.fn.domManip,m="_tmplitem",v=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,y={},_={},b={key:0,data:{}},w=0,k=0,x=[];e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,i){e.fn[t]=function(n){var r,a,s,o,l=[],u=e(n),c=1===this.length&&this[0].parentNode;if(f=y||{},c&&11===c.nodeType&&1===c.childNodes.length&&1===u.length)u[i](this[0]),l=this;else{for(a=0,s=u.length;s>a;a++)k=a,r=(a>0?this.clone(!0):this).get(),e(u[a])[i](r),l=l.concat(r);k=0,l=this.pushStack(l,t,u.selector)}return o=f,f=null,e.tmpl.complete(o),l}}),e.fn.extend({tmpl:function(t,i,n){return e.tmpl(this[0],t,i,n)},tmplItem:function(){return e.tmplItem(this[0])},template:function(t){return e.template(t,this[0])},domManip:function(t,i,n){if(t[0]&&e.isArray(t[0])){for(var r,a=e.makeArray(arguments),s=t[0],o=s.length,l=0;o>l&&!(r=e.data(s[l++],"tmplItem")););r&&k&&(a[2]=function(t){e.tmpl.afterManip(this,t,n)}),g.apply(this,a)}else g.apply(this,arguments);return k=0,f||e.tmpl.complete(y),this}}),e.extend({tmpl:function(n,r,s,o){var l,u=!o;if(u)o=b,n=e.template[n]||e.template(null,n),_={};else if(!n)return n=o.tmpl,y[o.key]=o,o.nodes=[],o.wrapped&&a(o,o.wrapped),e(i(o,null,o.tmpl(e,o)));return n?("function"==typeof r&&(r=r.call(o||{})),s&&s.wrapped&&a(s,s.wrapped),l=e.isArray(r)?e.map(r,function(e){return e?t(s,o,n,e):null}):[t(s,o,n,r)],u?e(i(o,null,l)):l):[]},tmplItem:function(t){var i;for(t instanceof e&&(t=t[0]);t&&1===t.nodeType&&!(i=e.data(t,"tmplItem"))&&(t=t.parentNode););return i||b},template:function(t,i){return i?("string"==typeof i?i=r(i):i instanceof e&&(i=i[0]||{}),i.nodeType&&(i=e.data(i,"tmpl")||e.data(i,"tmpl",r(i.innerHTML))),"string"==typeof t?e.template[t]=i:i):t?"string"!=typeof t?e.template(null,t):e.template[t]||e.template(null,v.test(t)?t:e(t)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),e.extend(e.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){y={}},afterManip:function(t,i,n){var r=11===i.nodeType?e.makeArray(i.childNodes):1===i.nodeType?[i]:[];n.call(t,i),l(r),k++}})}(jQuery),$.engagementPlugin=$.engagementPlugin||function(){function e(){"undefined"!=typeof FB&&$(".engagements_submission").each(function(){FB.XFBML.parse(this)})}var t=function(e,t){var n=$(this);i(n),n.hasClass("share_to_network")?(m(n,t),f(n,t)):y(n,t)},i=function(e){if("undefined"!=typeof dataLayer){var t=e.data("plugin_name");"signup_form"===t?dataLayer.push({event:"wf.signup.success"}):dataLayer.push({event:"wf.sweeps.success"})}},n=function(e,t){var i=JSON.parse(t.responseText);if(i.refresh){var n=$(this).closest(".widget").data("widget-pos");refreshWidgetContent(n)}else{var r=i.entry_errors;$(this).find(".engagements_errorbox").remove(),$(this).addClass("engagements_error"),$(".liked",this).removeClass("liked");for(var s in r){var o=$(this).siblings(".engagements_error_template");if("base"==s)o.tmpl(r[s]).prependTo($(this));else{var l=$(this).find("#engagements_entry_"+s+"_"+i.app_uuid);0===l.length?o.tmpl({errors:["An error has ocurred. Please refresh this page and try again."]}).prependTo($(this)):(l.addClass("engagements_error_field"),l.data("error_after_label")?l=l.next("label"):l.data("error_after_parent")&&(l=l.closest(l.data("error_after_parent"))),o.tmpl(r[s]).insertAfter(l))}}a(),h(this)}},r=function(){var e,t=$(this).closest("form"),i=t.find("[id^=engagements_entry_address_state]");"INPUT"==i[0].tagName&&(e=i.val()),$.ajax({url:$(this).data("states_path"),data:{selected_country:$(this).val()},beforeSend:function(){i.attr("disabled","disabled")},success:function(n){i.closest("ol").html(n),e&&t.find("[id^=engagements_entry_address_state]").val(e)}})},a=function(){$(".engagements_facebook_like iframe").each(function(e,t){var i=$(t);i.attr("src",i.attr("src"))})},s=function(e){var t=$(".engagements_facebook_like[data-fb-like]:not(.liked)",e),i=t.data("fb-like");return isNetwork("facebook")&&i?(a(),FB.api("/me/likes/"+i,function(i){i.data&&i.data.length>0?(t.addClass("liked"),$(e).data("remote",!0).submit()):($(e).addClass("engagements_error"),h(e))}),!1):!0},o=function(){$(".engagements_file_input").live("change",function(){var e=$(this).val().split("\\").pop();$(".engagements_no_file_selected_msg[data-file_input_id="+$(this).attr("id")+"]").html(e)}),$("input.engagements_post_to_feed").live("change",function(){p($(this).closest("form"))}),$("form.engagements_submission").live("ajax:success",t).live("ajax:error",n),$("form.engagements_submission").live("ajax:beforeSend ajax:remotipartSubmit",function(){d(this)}),$("form.engagements_submission.auth_required").live("ajax:beforeSend ajax:remotipartSubmit",function(){return $(this).hasClass("authenticated")!==!1?s(this):(fb_hidden_field=$(this).find('input[name$="[uid]"]:hidden'),0==fb_hidden_field.length?(h(this),!1):void 0)}),$("[id^=engagements_entry_address_country][data-states_path]").live("change",r)},l=function(){var e=$(".engagements_share_button");e.attr("disabled","disabled"),$(document).bind("afterfbinit",function(){u(function(){e.live("click",function(){var e=$(this);FB.login(function(t){t.authResponse&&g(e)})}),e.removeAttr("disabled")})})},u=function(e){FB.getLoginStatus(e)},c=function(){this.loadGooglePlusAPI=function(){$.ajax({url:"https://apis.google.com/js/plusone.js",dataType:"script",cache:!0,context:this})},this.isGooglePlusEnabled=function(){return $("div.engagements_google_plus_follow > div.g-plus").length>0},this.init=function(){this.isGooglePlusEnabled()&&this.loadGooglePlusAPI()},this.init(),$(document).on("didRefreshWidgetContent",$.proxy(function(){this.init()},this))},d=function(e){submit_button=$(e).find('input[type="submit"]'),submit_button.attr("disabled","disabled"),submit_button.val(submit_button.data("submitting-label"))},h=function(e){submit_button=$(e).find('input[type="submit"]'),submit_button.removeAttr("disabled"),submit_button.val(submit_button.data("submit-label"))},p=function(e){var t=e.find("input.engagements_post_to_feed");t.attr("checked")?(e.addClass("auth_required"),e.addClass("share_to_network")):e.data("network-auth-required")?(e.addClass("auth_required"),e.removeClass("share_to_network")):(e.removeClass("auth_required"),e.removeClass("share_to_network"))},f=function(e,t){var i=$.available_networks;1==i.length&&"facebook"==i[0]?g(e,function(i){i&&i.post_id&&v(e),y(e,t)}):y(e,t)},g=function(e,t){var i=e.data("title_text"),n=e.data("description"),r=e.data("title_link"),a=e.data("image"),s={name:e.data("action_text"),link:e.data("action_link")},o={method:"feed",name:i,caption:" ",link:r,picture:a,description:n,display:"iframe",actions:s};FB.ui(o,t)},m=function(e,t){void 0!==t.referral_url_title_link&&e.data("title_link",t.referral_url_title_link),void 0!==t.referral_url_action_link&&e.data("action_link",t.referral_url_action_link)},v=function(e){$.ajax({type:"POST",url:$.trackingTrackShareUrl,data:{uuid:e.data("uuid"),plugin_context:e.find('input[name="plugin_context"]').val()}})},y=function(e,t){var i=t.redirect_url,n=t.redirect_post,r=t.target,a=t.entry_data,s=t.plugin_params;if(i)if(n){var o=$("<form></form>").attr("action",i).attr("target",r).attr("method","POST").css("display","none");for(var l in a){var u=$("<input></input>").attr("type","hidden").attr("name",l).val(a[l]);u.appendTo(o)}o.insertAfter(e).submit()}else window.open(i,r);else{var c=e.closest(".widget").data("widget-pos");PageManager.pluginParams[c]=s,refreshWidgetContent(c)}},_=function(){function e(e){var t=e.data("perms"),i="user_likes";t&&t.length>0?$.inArray(i,t)<0&&(t=[t,i].join()):t=i,e.data("perms",t)}isNetwork("facebook")&&$("form.engagements_submission").each(function(){var t=$(this),i=$(".engagements_facebook_like[data-fb-like]:not(.liked)",t),n=i.data("fb-like");n&&e(t)})},b=function(e){if(void 0!==$.analyticsTrackConnectionUrl){var t,i,n=$(e),r=n.closest("form.engagements_submission"),a=n.data("page-id");a&&r.length>0&&(t=$("input[name='plugin_context']",r).val(),i={uuid:r.data("uuid"),plugin_context:t,target_property_id:a,source:"facebook"},$.post($.analyticsTrackConnectionUrl,i))}};$(document).bind("afterfbinit",function(){FB.Event.subscribe("edge.create",function(e,t){b(t)})});var w=function(){l(),o();var e=e||new c($(".engagements_submission"));_()};return $(function(){w()}),$(document).on("didRefreshWidgetContent",function(){e(),_()}),!0}(),/* =========================================================
 * bootstrap-modal.js v2.0.1
 * http://twitter.github.com/bootstrap/javascript.html#modals
 * =========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */
!function(e){"use strict";function t(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),i.call(t)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),i.call(t)})}function i(){this.$element.hide().trigger("hidden"),n.call(this)}function n(t){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=e.support.transition&&i;this.$backdrop=e('<div class="modal-backdrop '+i+'" />').appendTo(document.body),"static"!=this.options.backdrop&&this.$backdrop.click(e.proxy(this.hide,this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),n?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(r,this)):r.call(this)):t&&t()}function r(){this.$backdrop.remove(),this.$backdrop=null}function a(){var t=this;this.isShown&&this.options.keyboard?e(document).on("keyup.dismiss.modal",function(e){27==e.which&&t.hide()}):this.isShown||e(document).off("keyup.dismiss.modal")}var s=function(t,i){this.options=i,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};s.prototype={constructor:s,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this;this.isShown||(e("body").addClass("modal-open"),this.isShown=!0,this.$element.trigger("show"),a.call(this),n.call(this,function(){var i=e.support.transition&&t.$element.hasClass("fade");!t.$element.parent().length&&t.$element.appendTo(document.body),t.$element.show(),i&&t.$element[0].offsetWidth,t.$element.addClass("in"),i?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")}))},hide:function(n){n&&n.preventDefault(),this.isShown&&(this.isShown=!1,e("body").removeClass("modal-open"),a.call(this),this.$element.trigger("hide").removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?t.call(this):i.call(this))}},e.fn.modal=function(t){return this.each(function(){var i=e(this),n=i.data("modal"),r=e.extend({},e.fn.modal.defaults,i.data(),"object"==typeof t&&t);n||i.data("modal",n=new s(this,r)),"string"==typeof t?n[t]():r.show&&n.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=s,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var i,n=e(this),r=e(n.attr("data-target")||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),a=r.data("modal")?"toggle":e.extend({},r.data(),n.data());t.preventDefault(),r.modal(a)})})}(window.jQuery),$(function(){$(".engagements_official_rules_modal, .engagements_privacy_policy_modal").modal({backdrop:!1,show:!1}),$("a.engagements_rules_link, a.engagements_privacy_policy_link").live("click",function(){var e="."+$(this).data("target_class")+'[data-app_uuid="'+$(this).data("app_uuid")+'"]';$(e).modal("hide"),0==$(this).siblings(e).length?($(this).after($(e+":first").clone()),$(this).siblings(e).modal({backdrop:!1,show:!0})):$(this).siblings(e).modal("show")}),$(".modal a.close").live("click",function(e){$(this).parents(".modal").modal("hide"),e.stopPropagation()})});